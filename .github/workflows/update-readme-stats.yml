name: 📊 Update GitHub Profile Metrics
on:
  schedule:
    - cron: '0 */6 * * *' # Every 6 hours
  workflow_dispatch: # Manual trigger

jobs:
  update-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Required to commit the SVG
    steps:
      - name: 🛎️ Checkout Repository
        uses: actions/checkout@v4
        
      - name: 📈 Generate GitHub Metrics (with private contributions)
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: racar
          filename: github-metrics.svg
          output_dir: .
          
          # 🎨 LAYOUT & DESIGN FIXES
          config_display: large
          config_base64: no
          config_padding: 6%, 8% + 11px
          config_output: svg
          config_animations: yes
          config_timezone: America/Bogota
          
          # 📏 SIZE & FONT OPTIMIZATION
          config_font_size: 12
          config_font_weight: normal
          config_scale: 1.0
          
          # 📋 CONTENT CONFIGURATION
          base: header, metadata
          repositories_forks: no
          
          # 🏷️ PROFILE TITLE
          plugin_introduction: yes
          plugin_introduction_title: yes
          
          # 📅 CALENDAR (COMPACT)
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year
          
          # 🤝 CONTRIBUTIONS
          plugin_contributions: yes
          plugin_contributions_display: compact
          
          # 💬 LANGUAGES (OPTIMIZED)
          plugin_languages: yes
          plugin_languages_limit: 6
          plugin_languages_threshold: 0%
          plugin_languages_sections: most-used, recently-used
          plugin_languages_details: percentage, bytes-size
          plugin_languages_colors: vibrant
          plugin_languages_aliases: "Kotlin:kotlin, Ruby:ruby, Java:java"
          plugin_languages_ignored: >-
            javascript, html, css, typescript, json, yaml, yml,
            liquid, markdown, makefile, dockerfile, shell, bash
          plugin_languages_additional: kotlin, ruby, java
          
          # 🛠️ TECHNOLOGIES 
          plugin_notable: yes
          plugin_notable_from: organization
          plugin_notable_types: commit
          
          # 📊 ACTIVITY
          plugin_activity: no
          
          # 🎯 ACHIEVEMENTS (COMPACT)
          plugin_achievements: no
          
          # 🔥 STREAKS (SIMPLE)
          plugin_habits: no
          
          # ⭐ STARS & TOPICS
          plugin_topics: yes
          plugin_topics_mode: icons
          plugin_topics_limit: 12
          
      - name: 💾 Commit & Push Metrics SVG
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action Bot"
          git pull origin main || echo "No changes to pull"
          git add github-metrics.svg
          git commit -m "📈 Auto-update metrics SVG [$(date +'%Y-%m-%d %H:%M')]" || echo "No changes to commit"
          git push origin main