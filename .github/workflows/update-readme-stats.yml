name: ğŸ“Š Update GitHub Profile Metrics
on:
  schedule:
    - cron: '0 */6 * * *' # Every 6 hours
  workflow_dispatch: # Manual trigger

jobs:
  update-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Required to commit the SVG
    steps:
      - name: ğŸ›ï¸ Checkout Repository
        uses: actions/checkout@v4
        
      - name: ğŸ“ˆ Generate GitHub Metrics (with private contributions)
        uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          user: racar
          filename: github-metrics.svg
          output_dir: .
          
          # ğŸ¨ LAYOUT & DESIGN FIXES
          config_display: large
          config_base64: no
          config_padding: 6%, 8% + 11px
          config_output: svg
          config_animations: yes
          config_timezone: America/Bogota
          
          # ğŸ“ SIZE & FONT OPTIMIZATION
          config_font_size: 12
          config_font_weight: normal
          config_scale: 1.0
          
          # ğŸ“‹ CONTENT CONFIGURATION
          base: header, community, metadata
          repositories_forks: no
          
          # ğŸ·ï¸ PROFILE TITLE
          plugin_introduction: yes
          plugin_introduction_title: yes
          
          # ğŸ“… CALENDAR (COMPACT)
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year
          
          # ğŸ¤ CONTRIBUTIONS
          plugin_contributions: yes
          plugin_contributions_display: compact
          
          # ğŸ’¬ LANGUAGES (OPTIMIZED)
          plugin_languages: yes
          plugin_languages_limit: 6
          plugin_languages_threshold: 0%
          plugin_languages_sections: most-used, recently-used
          plugin_languages_details: percentage, bytes-size
          plugin_languages_colors: github
          plugin_languages_aliases: "Kotlin:kotlin, Ruby:ruby, Java:java"
          plugin_languages_ignored: >-
            javascript, html, css, typescript, json, yaml, yml, 
            liquid, markdown, makefile, dockerfile, shell, bash
          plugin_languages_additional: kotlin, ruby, java
          
          # ğŸ› ï¸ TECHNOLOGIES 
          plugin_notable: yes
          plugin_notable_from: organization
          plugin_notable_types: commit
          
          # ğŸ“Š ACTIVITY
          plugin_activity: yes
          plugin_activity_limit: 4
          plugin_activity_days: 30
          plugin_activity_filter: all
          plugin_activity_visibility: all
          plugin_activity_timestamps: yes
          
          # ğŸ¯ ACHIEVEMENTS (COMPACT)
          plugin_achievements: yes
          plugin_achievements_display: compact
          plugin_achievements_secrets: yes
          plugin_achievements_threshold: C
          
          # ğŸ”¥ STREAKS (SIMPLE)
          plugin_habits: yes
          plugin_habits_from: 200
          plugin_habits_days: 30
          plugin_habits_facts: yes
          plugin_habits_charts: no
          
          # â­ STARS & TOPICS
          plugin_topics: yes
          plugin_topics_mode: icons
          plugin_topics_limit: 12
          
      - name: ğŸ’¾ Commit & Push Metrics SVG
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action Bot"
          git pull origin main || echo "No changes to pull"
          git add github-metrics.svg
          git commit -m "ğŸ“ˆ Auto-update metrics SVG [$(date +'%Y-%m-%d %H:%M')]" || echo "No changes to commit"
          git push origin main